# Database

## ACID
### Ссылки
- https://habr.com/ru/post/555920/
- https://habr.com/ru/post/469415/
###
- Atomicity (Атомарность) - невозможно разбиение на меньшие части, когда выполнена часть и возникает ошибка, то полный откат траназкции
- Consistency (Согласованность) - то что БД находится в "хорошем" состоянии
- Isolation (Изоляция) - выполняеимые транзакции не должны мешать друг другу. Должны видеть результат.
- Durability (Сохраняемость) - обязательство БД не терять данные, даже в случае фотального сбоя. Backup и репликация.

ИЛИ
- Atomicity (Атомарность) - все или ничего
- Consistency (Согласованность) - ограничение целостности и пользовательские ограничения
- Isolation (Изоляция) - влияние парал. процессов
- Durability (Сохраняемость) - сохраннность данных даже в случае сбоя

#### Isolation (Изоляция)
- Полное блокирование
- Несколько версий одной и той же строки (так в Pg)
Снимок данных - согласованный срез на определенный момент времени. Существуют разные версии строки.
Существует очистка версий строк, которые уже не нужны. Происходит в фоне. Хранятся все версии в одном пространстве\файле таблицы.

Уровни иозоляции транзакции отличаются временем создания среза:
- Read Uncommited - чтение незакомиченных данных. Не поддерживается в Pg работает, как Read Commited
- Read Commited (по умолчанию) - снимок строится на момент начала оператора; одинаковые запросы могут каждый раз получать разные данные.
- Repeatable Read - снимок строится на момент начала первого оператора транзакции; транзакция может завершиться ошибкой сериализации.
- Serializable - полная изоляция

Статусы транзакции в Pg
- Статус xact - 2 bit
- Фиксация
- Откат

## CAP
### Ссылки
- https://habr.com/ru/post/328792/

В CAP говорится, что в распределенной системе возможно выбрать только 2 из 3-х свойств:
- C (consistency) — согласованность. Каждое чтение даст вам самую последнюю запись.
- A (availability) — доступность. Каждый узел (не упавший) всегда успешно выполняет запросы (на чтение и запись).
- P (partition tolerance) — устойчивость к распределению. Даже если между узлами нет связи, они продолжают работать независимо друг от друга.

## Нормализация данных
- Данные дублируются (сложно поддерживать согласованность, сложно обновлять, сложно писать запросы)
- Данные без схем (поддержка согласованности на стороне приложения, сложно писать запросы, низкая производительность)

Нормализация - уменьшение избыточности. Отсутствие избыточности в данных делает работу удобнее и упрощает поддержку согласованности данных.



